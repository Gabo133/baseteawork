{% extends "Partials/_Base.html" %}
{% load static %}
{% block Title %}
Inicio
{% endblock Title %}
{% block Style %}
<style>
	th {
		font-size: 1.5hz;
		font-size: 1.5vh;
	}
</style>
{% endblock Style %}
{% block Content %}

<div class="section__content section__content--p30">
	<div class="container-fluid">

		<div class="row">
			<div class="col-md">
				<div class="card">
					<div class="card-header" style="background-color: rgb(82,183,78) "> 

					  	<div  class="nav nav-tabs justify-content-center" id="nav-tab" role="tablist">
					  		
					  		<a class="nav-item nav-link active" id="nav-Uni-tab" data-toggle="tab" href="#nav-Uni" role="tab" aria-controls="nav-Uni" aria-selected="true" style="color:rgb(85,85,89)">Camiones Rígidos</a>

					  		<button class="nav-item nav-link" id="nav-Uni-To" data-toggle="tab" href="#nav-Uni-To" role="tab" aria-controls="nav-Uni-To" aria-selected="true" style="color:rgb(85,85,89); background-color: #999090;" disabled>Tonelaje</button>
						    
					  	</div>
					</div>

					<div class="card-body">
						<div class="tab-content " id="nav-tabContent" >
							<div class="tab-pane fade show active" id="nav-Uni"  role="tabpanel" aria-labelledby="nav-Uni-tab">
								<div class="table-responsive table--no-card m-b-30"  style="text-align: center;">
									<form action="{% url 'CamionesUnitarios' flota.pk %}" class="form-horizontal" method="POST" >
										{% csrf_token %}
										<table class = "table table-bordered"   id="ss">
											<thead>
												<tr>
													<th>Tipo de combustible</th>
													<th>Número de Camiones</th>
													<th>Año</th>
													<th>Tecnología</th>
													<th>Peso bruto vehicular</th>
													<th>Kilómetros promedios por camión por año</th>
													<th>Litros de combustible consumidos por camión por año</th>
													<th>Promedio de carga útil en toneladas por viaje</th>
													<th>Promedio de horas de ralentí por día</th>
													<th>Días de operación al año</th>
													<th>Proporción recorrido tramo Urbano/Interurbano</th>
													<th>Velocidad promedio Urbano/Interurbano</th>
												</tr>
											</thead>
											<!-- <tbody>
												<tr>
													<td><strong>Diesel</strong></td>
													<td><input min="0" name="Diesel-1" id="Diesel-1" value="{{diesel.Numero_Camiones}}" type="number" class="group-form" style="width: 100%;text-align: center;"></td>
													<td><input type="number" class="group-form" min="0" name="Diesel-2" id="Diesel-2" value="{{diesel.Kilometros_Promedio}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Diesel-3" id="Diesel-3" value="{{diesel.Litros_Combustible}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Diesel-4" id="Diesel-4" value="{{diesel.Promedio_Carga}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Diesel-5" id="Diesel-5" value="{{diesel.Promedio_Ralenti}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Diesel-6" id="Diesel-6" value="{{diesel.Dias_Operacion}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Diesel-7" id="Diesel-7" value="{{diesel.Velocidad}}" style="width: 100%;text-align:center;"></td>
												
												</tr>
												<tr>
													<td><strong>Gasolina</strong></td>
													<td><input min="0" name="Gasolina-1" id="Gasolina-1" value="{{gasolina.Numero_Camiones}}" type="number" class="group-form" style="width: 100%;text-align: center;"></td>
													<td><input type="number" class="group-form" min="0" name="Gasolina-2" id="Gasolina-2" value="{{gasolina.Kilometros_Promedio}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Gasolina-3" id="Gasolina-3" value="{{gasolina.Litros_Combustible}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Gasolina-4" id="Gasolina-4" value="{{gasolina.Promedio_Carga}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Gasolina-5" id="Gasolina-5" value="{{gasolina.Promedio_Ralenti}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Gasolina-6" id="Gasolina-6" value="{{gasolina.Dias_Operacion}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Gasolina-7" id="Gasolina-7" value="{{gasolina.Velocidad}}" style="width: 100%;text-align:center;"></td>
													
												</tr>
												<tr>
													<td><strong>Combustible Alterno</strong></td>
													<td><input align="center" min="0" name="Combustible-1" id="Combustible-1" value="{{combustible.Numero_Camiones}}" type="number" class="group-form" style="width: 100%;text-align: center;"></td>
													<td><input type="number" class="group-form" min="0" name="Combustible-2" id="Combustible-2" value="{{combustible.Kilometros_Promedio}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Combustible-3" id="Combustible-3" value="{{combustible.Litros_Combustible}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Combustible-4" id="Combustible-4" value="{{combustible.Promedio_Carga}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Combustible-5" id="Combustible-5" value="{{combustible.Promedio_Ralenti}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Combustible-6" id="Combustible-6" value="{{combustible.Dias_Operacion}}" style="width: 100%;text-align:center;"></td>
													<td><input type="number" class="group-form" min="0" name="Combustible-7" id="Combustible-7" value="{{combustible.Velocidad}}" style="width: 100%;text-align:center;"></td>
												</tr>
											</tbody> -->
										</table>	
									</form>	
									<div align="right">
										<button type="submit" id="enviar_info" class="btn btn-success">Siguiente</button>
									</div>
								</div>
								
								
							</div>
						</div>
					
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-8">
				<div class="card">
					<div class="table-responsive table--no-card m-b-30">
						<table class = "table table-bordered" style="font-size: 12px;">
							<thead>
								<tr>
									<th></th>
									<th>Kilómetros Totales</th>
									<th>Litros totales de combustible consumido</th>
									<th>Rendimiento promedio (Kilómentros/Litros)</th>
									<th>Total horas ratentí anual</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td><strong>Diesel</strong></td>
									<td><input id="d1" value="0" disabled="true" style="width: 100%;text-align:center;" disabled="true"></td>
									<td><input id="d2" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="d3" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="d4" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
								</tr>
								<tr>
									<td><strong>Gasolina</strong></td>
									<td><input id="g1" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="g2" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="g3" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="g4" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
								</tr>
								<tr>
									<td><strong>Combustible Alterno</strong></td>
									<td><input id="c1" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="c2" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="c3" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
									<td><input id="c4" value="0" disabled="true" style="width: 100%;text-align:center;"></td>
								</tr>
							</tbody>
						</table>	
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


{% endblock Content %}
{% block JavaScript %}
<script>
$(document).ready(function(){
	function getCookie(name){
      var cookieValue = null;
      if (document.cookie && document.cookie != ''){
          var cookies = document.cookie.split(';');
          for(var i = 0; i < cookies.length; i++){
              var cookie = jQuery.trim(cookies[i]);

              if(cookie.substring(0,name.length + 1) == (name + '=')){
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue
    }
    function reverse(num){
            var x = num.length;
            var cadena = "";
            while (x>=0) {
                cadena = cadena + num.charAt(x);
                x--;
            }
            return cadena;
        }
        function format(num) {
            var cont = 0;
            final = '';
            revese = reverse(num.toString())
            for (var i = 0; i < parseInt(revese.length); i++) {
                if(cont == 3){
                    final += '.' + revese[i];
                    cont = 1;
                }else{
                    cont += 1;
                    final+= revese[i];  
                }
            }
            return(reverse(final));
        }
	$("#ss").on('change',function(){
		var num_cam_d = $("#Diesel-1").val();
		var kilo_d = $("#Diesel-2").val();
		var litros_d = $("#Diesel-3").val();
		var rale_d = $("#Diesel-5").val();
		var dias_d = $("#Diesel-6").val();
		$("#d1").val(format(num_cam_d * kilo_d));
		$("#d2").val(format(litros_d*num_cam_d));
		if(litros_d != 0){
			$("#d3").val(Number((kilo_d/litros_d).toFixed(2)) + " K/L");
		} 
		$("#d4").val(format(dias_d*rale_d*num_cam_d));
		var num_cam_g = $("#Gasolina-1").val();
		var kilo_g = $("#Gasolina-2").val();
		var litros_g = $("#Gasolina-3").val();
		var rale_g = $("#Gasolina-5").val();
		var dias_g = $("#Gasolina-6").val();
		$("#g1").val(format(num_cam_g*kilo_g));
		$("#g2").val(format(litros_g*num_cam_g));
		if(litros_g != 0){

			$("#g3").val(Number((kilo_g/litros_g).toFixed(2)) + " K/L");
		}
		$("#g4").val(format(dias_g*rale_g*num_cam_g));

		var num_cam_c = $("#Combustible-1").val();
		var kilo_c = $("#Combustible-2").val();
		var litros_c = $("#Combustible-3").val();
		var rale_c = $("#Combustible-5").val();
		var dias_c = $("#Combustible-6").val();
		$("#c1").val(format(num_cam_c*kilo_c));
		$("#c2").val(format(litros_c*num_cam_c));
		if(litros_c != 0){
			$("#c3").val(Number((kilo_c/litros_c).toFixed(2)) + " K/l");
			
		}
		$("#c4").val(format(dias_c*rale_c*num_cam_c));
		});
	$("#enviar_info").on('click', function(event) {
		
		var dato = [];
		var diesel = [];
		var gasolina = [];
		var combustible = [];
		diesel.push(parseInt($("#Diesel-1").val()));
		diesel.push(parseInt($("#Diesel-2").val()));
		diesel.push(parseInt($("#Diesel-3").val()));
		diesel.push(parseInt($("#Diesel-4").val()));
		diesel.push(parseInt($("#Diesel-5").val()));
		diesel.push(parseInt($("#Diesel-6").val()));
		diesel.push(parseInt($("#Diesel-7").val()));

		var i;
		for (i = 0; i < 7; i++) { 
  			if(diesel[i] == ""){
  				diesel[i] = 0
  			}if(typeof(diesel[i]) != typeof(NaN)){
  				diesel[i] = 0;
  			}
		}
		gasolina.push(parseInt($("#Gasolina-1").val()));
		gasolina.push(parseInt($("#Gasolina-2").val()));
		gasolina.push(parseInt($("#Gasolina-3").val()));
		gasolina.push(parseInt($("#Gasolina-4").val()));
		gasolina.push(parseInt($("#Gasolina-5").val()));
		gasolina.push(parseInt($("#Gasolina-6").val()));
		gasolina.push(parseInt($("#Gasolina-7").val()));

		var i;
		for (i = 0; i < 7; i++) { 
  			if(gasolina[i] == ""){
  				gasolina[i] = 0
  			}if(typeof(gasolina[i]) != typeof(NaN)){
  				gasolina[i] = 0;
  			}
		}
		combustible.push(parseInt($("#Combustible-1").val()));
		combustible.push(parseInt($("#Combustible-2").val()));
		combustible.push(parseInt($("#Combustible-3").val()));
		combustible.push(parseInt($("#Combustible-4").val()));
		combustible.push(parseInt($("#Combustible-5").val()));
		combustible.push(parseInt($("#Combustible-6").val()));
		combustible.push(parseInt($("#Combustible-7").val()));

		var i;
		for (i = 0; i < 7; i++) { 
  			if(combustible[i] == ""){
  				combustible[i] = 0;
  			}if(typeof(combustible[i]) != typeof(NaN)){
  				combustible[i] = 0;
  			}
		}
		$.ajax({
          url:'{% url "CamionesUnitarios" flota.pk %}',
          type: "POST",
          data: {
            csrfmiddlewaretoken: getCookie('csrftoken'),
            'diesel':String(diesel),
            'gasolina':String(gasolina),
            'combustible':String(combustible),
          },
          success: function(){
          	window.location.replace("{% url 'TonUnitario' flota.pk %}")
          }                                            
        });
	});
var num_cam_d = $("#Diesel-1").val();
var kilo_d = $("#Diesel-2").val();
var litros_d = $("#Diesel-3").val();
var rale_d = $("#Diesel-5").val();
var dias_d = $("#Diesel-6").val();
$("#d1").val(format(num_cam_d * kilo_d));
$("#d2").val(format(litros_d*num_cam_d));
if(litros_d != 0){
	$("#d3").val(Number((kilo_d/litros_d).toFixed(2)) + " K/L");
} 
$("#d4").val(format(dias_d*rale_d*num_cam_d));
var num_cam_g = $("#Gasolina-1").val();
var kilo_g = $("#Gasolina-2").val();
var litros_g = $("#Gasolina-3").val();
var rale_g = $("#Gasolina-5").val();
var dias_g = $("#Gasolina-6").val();
$("#g1").val(format(num_cam_g*kilo_g));
$("#g2").val(format(litros_g*num_cam_g));
if(litros_g != 0){

	$("#g3").val(Number((kilo_g/litros_g).toFixed(2)) + " K/L");
}
$("#g4").val(format(dias_g*rale_g*num_cam_g));

var num_cam_c = $("#Combustible-1").val();
var kilo_c = $("#Combustible-2").val();
var litros_c = $("#Combustible-3").val();
var rale_c = $("#Combustible-5").val();
var dias_c = $("#Combustible-6").val();
$("#c1").val(num_cam_c*kilo_c);
$("#c2").val(litros_c*num_cam_c);
if(litros_c != 0){
	$("#c3").val(Number((kilo_c/litros_c).toFixed(2)) + " K/l");
	
}
$("#c4").val(format(dias_c*rale_c*num_cam_c));
});
</script>
{% endblock JavaScript %}