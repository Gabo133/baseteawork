{% extends "Partials/_Base.html" %}
{% load static %}
{% block Title %}
Inicio
{% endblock Title %}
{% block Style %}
{% endblock Style %}
{% block Content %}

<div class="section__content section__content--p30">
	<div class="container-fluid">

		<div class="row">
			<div class="col-md">
				<div class="card">
					<div class="card-header" style="text-align: center;">
						<h2>Empresas</h2>
					</div>
					<div class="card-body">
						<div class="table-responsive table--no-card m-b-30">
							<table class="table table-striped">
								<tdead>
									<tr>
										<th>Modulo</th>
										<th>Completado</th>
										<th>Detalle</th>
									</tr>
								</tdead>
								<tbody>
									<tr>
										<td>Mi Información</td>
										{% if info.0 == True%}
											<td ><i style="color:green" class="fas fa-check-circle"></i></td>
										{% else %}
											<td><i style="color:red" class="fas fa-times"></i></td>

										{% endif %}
										<td>
											{% if info.0 != True %}
												<button class="btn btn-primary" id="mi">Ver Detalle</button>
											{% endif %}
											
											<div style="display:none" id="hidmi">
												{% for x in info.3 %}
													<li style="color:red;">{{x}}s</li>
												{% endfor %}
											</div>

										</td>
									</tr>
									<tr>
										<td>Generar Reporte</td>
										{% if info.5 == True %}
											<td ><i style="color:green" class="fas fa-check-circle"></i></td>
										{% else %}
											<td><i style="color:red" class="fas fa-times"></i></td>

										{% endif %}
										<td></td>
									</tr>
									<tr>
										<td>Descripción de Flota</td>
										{% if info.1 == True %}
											<td ><i style="color:green" class="fas fa-check-circle"></i></td>
										{% else %}
											<td><i style="color:red" class="fas fa-times"></i></td>

										{% endif %}
										<td></td>
									</tr>
									{% for i in info.4 %}
									<tr>
										<td>
											<li>{{i.0.0}}</li>
										</td>
										{% if i.3 == True %}
											<td ><i style="color:green" class="fas fa-check-circle"></i></td>
										{% else %}
											<td><i style="color:red" class="fas fa-times"></i></td>

										{% endif %}
										<td>
											{% if i.3 != True %}
												<button class="btn btn-primary" id="{{i.1.0}}">Ver Detalle</button>
											{% endif %}
											
											<div style="display:none" id="hid{{i.1.0}}">
												{% for x in i.2 %}
													<li style="color:red;">{{x}}</li>
												{% endfor %}
											</div>
										</td>
									</tr>
									{% endfor %}
								</tbody>
							</table>
							<div style="text-align: right;">
								<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#OperacionModal">Enviar Información</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="OperacionModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">  
	<div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body">
      	<p>La Información será enviada para su revisión.</p>
		<div class="modal-footer">
		    <button type="button" id="enviar" class="btn btn-success" data-dismiss="modal">Enviar</button>
		    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
		</div>
      </div>
    </div>
  </div>
</div>
{% endblock Content %}
{% block JavaScript %}
<script>
$(document).ready(function(){
	function getCookie(name){
      var cookieValue = null;
      if (document.cookie && document.cookie != ''){
          var cookies = document.cookie.split(';');
          for(var i = 0; i < cookies.length; i++){
              var cookie = jQuery.trim(cookies[i]);

              if(cookie.substring(0,name.length + 1) == (name + '=')){
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue
    }
	{% for i in info.4 %}
		$("#{{i.1.0}}").on("click",function(){
			if($("#hid{{i.1.0}}").is(":visible")){
				$("#hid{{i.1.0}}").hide();
			}else{
				$("#hid{{i.1.0}}").show();
				
			}
		});
	{% endfor %}
	$("#mi").on("click",function(){
			if($("#hidmi").is(":visible")){
				$("#hidmi").hide();
			}else{
				$("#hidmi").show();
				
			}
		});
	$("#enviar").on('click', function(event) {
		$.ajax({
          url:'{% url "Validar" %}',
          type: "POST",
          data: {
            csrfmiddlewaretoken: getCookie('csrftoken'),
          },
          success: function(dato){
          	alert(dato.message);
          	window.location.replace("{% url 'Index' %}");
          }                                            
        });
	});
});
</script>
{% endblock JavaScript %}